<!DOCTYPE html>
<html lang="am">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>IT Maintenance Request - FDRE Customs Commission Hawassa Branch</title>
  <style>
    /* (same styling as before - kept concise) */
    body { font-family: 'Segoe UI', Tahoma, sans-serif; background: linear-gradient(135deg,#f0f4f8,#d9e8ff); margin:0; }
    header { display:flex; align-items:center; justify-content:space-between; padding:15px 30px; background:#003366; color:#fff; }
    header img { width:80px; height:auto; }
    .header-text { text-align:right; }
    .form-container { max-width:600px; margin:30px auto; background:#fff; padding:25px; border-radius:12px; box-shadow:0 4px 15px rgba(0,0,0,0.1); }
    label{display:block;margin-bottom:6px;font-weight:700;color:#333}
    input, select { width:100%; padding:10px; margin-bottom:18px; border:1px solid #ccc; border-radius:8px; font-size:14px; }
    button { background:#003366;color:#fff;border:none;padding:12px;border-radius:8px;cursor:pointer;width:100%;font-size:16px }
    button:disabled { opacity:0.6; cursor:not-allowed; }
    .message { text-align:center; margin-top:12px; font-weight:700; display:none; }
  </style>
</head>
<body>

  <header>
    <img src="gumu.jpg" alt="Customs Commission Logo">
    <div class="header-text">
      <h1>FDRE Customs Commission</h1>
      <h2>Hawassa Branch</h2>
    </div>
  </header>

  <main class="form-container">
    <h3>የጥገና እና ድጋፍ መጠየቂያ ቅፅ</h3>

    <form id="maintenanceForm">
      <label for="fullname">የአገልግሎት ፈላጊ ሙሉ ስም</label>
      <input id="fullname" name="fullname" required placeholder="">

      <label for="date">ቀን</label>
      <input id="date" name="date" type="text" required>

      <label for="department">የሥራ ክፍል</label>
      <input id="department" name="department" required placeholder="">

      <label for="type">የፈለጉት የጥገና አይነት</label>
      <select id="type" name="type" required>
        <option value="" disabled selected>ይምረጡ</option>
        <option value="Printer Problem">Printer</option>
        <option value="System Issue">System</option>
        <option value="Network Issue">Network</option>
        <option value="Computer ">Computer</option>
        <option value="Photocopy ">Photocopy </option>
        <option value="Scanner">Scanner </option>
        <option value="Other">ሌላ</option>
      </select>

      <button id="submitBtn" type="submit">ጥያቄውን ይላኩ</button>
    </form>

    <div id="msg" class="message" role="status" aria-live="polite"></div>
  </main>

  <footer style="text-align:center;padding:15px;color:#555">&copy; 2025 FDRE Customs Commission - Hawassa Branch-IT Support Team</footer>

  <script>
    const form = document.getElementById('maintenanceForm');
    const submitBtn = document.getElementById('submitBtn');
    const msg = document.getElementById('msg');

    form.addEventListener('submit', async (e) => {
      e.preventDefault();
      msg.style.display = 'none';
      submitBtn.disabled = true;
      submitBtn.innerText = 'loading...';

      const data = {
        fullname: document.getElementById('fullname').value.trim(),
        date: document.getElementById('date').value,
        department: document.getElementById('department').value.trim(),
        type: document.getElementById('type').value
      };

      try {
        const res = await fetch('/api/submit', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify(data)
        });

        const json = await res.json();

        if (res.ok && json.status === 'success') {
          msg.style.display = 'block';
          msg.style.color = 'green';
          msg.innerText = '✅ DONE' + (json.message || 'Request sent successfully');
          form.reset();
        } else {
          msg.style.display = 'block';
          msg.style.color = 'red';
          msg.innerText = '❌ ' + (json.message || 'Submission failed');
        }
      } catch (err) {
        msg.style.display = 'block';
        msg.style.color = 'red';
        msg.innerText = '❌ Network or server error: ' + (err.message || err);
      } finally {
        submitBtn.disabled = false;
        submitBtn.innerText = 'ጥያቄውን ይላኩ';
      }
    });
  </script>
</body>
</html>
